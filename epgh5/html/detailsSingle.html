<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <title>香蜜沉沉烬如霜</title>
    <meta charset="UTF-8">
    <link href="../css/global.css" type="text/css" rel="stylesheet">
    <link href="../css/common.css" type="text/css" rel="stylesheet">
    <link rel="stylesheet" href="../css/details.css">
</head>

<body>
<div class="loading_mask">
    <div class="spinner"></div>
</div>
    <div id="pageContent" class="page-content videoInfo black">
        <div class="sel_lr">
            <img src="../img/logo.png" alt="">
            <span class="sel_time"></span>
        </div>
        <div>
            <div class="videoCon clear col aty details_page">
                <img src="../img/m.png">
                <div class="detail_title">
                  <h3>香蜜沉沉烬如霜</h3>
                    <h6>地区 : 大陆 <span style="margin: 0 1.354vw;">|</span> 2018</h6>
                  <h6>美国 : 2018 <span style="margin: 0 1.354vw;">|</span> 科幻</h6>
                  <h6>约翰.博耶加 / 斯科特.伊斯特伍德</h6>
                  <p>纵使贵为神尊，仍不免为情所困，落入自家的红尘落网。花神梓芬被爱情几乎夺去性命，弥留之际，她将陨丹喂给刚出生不久女儿 锦觅（杨紫 饰），以帮她断情绝爱，免去万年之中的一场情劫。母亲去世后，锦觅在结界的保护下过着悠然自在的生活。然而随着 年岁的长大，她开始对外面的世界充满好奇。命中注定的机缘，锦觅救下了天帝之子旭凤（邓伦 饰）。以此为机缘，锦觅第一次跨 过结界，随着旭凤来到天界。在相处的过程中，高傲的旭凤渐渐对这个机灵可爱的小花神动了心……</p>
                  <ul class="tops">
                    <li tabindex="1" class="li play active">
                      <img src="../img/logo1.png">
                      <p>播放</p>
                    </li>
                    <!--<li tabindex="2" class="li coll">-->
                      <!--<img src="../img/logo2.png">-->
                      <!--<p>收藏</p>-->
                    <!--</li>-->
                    <!--<li tabindex="3" class="li vip">-->
                        <!--<img src="../img/gao.png" alt="">-->
                    <!--</li>-->
                  </ul>
                </div>
            </div>

            <div class="col tuijian details_tj">
            <h4 class="titelH4 singleH4">为你推荐</h4>
            <div class="videoList" style="position: relative;bottom: 0; padding: 0">
                <!-- 剧集推荐 把默认放在了这里-->
                <div class="ulWrap">
                    <ul class="tj">
                        <li tabindex="4" class="li">
                            <img src="../img/m.jpg">
                         </li>
                        <li tabindex="5" class="li">
                            <img src="../img/m.jpg">
                         </li>
                        <li tabindex="6" class="li">
                            <img src="../img/m.jpg">
                         </li>
                        <li tabindex="7" class="li">
                            <img src="../img/m.jpg">
                         </li>
                        <li tabindex="8" class="li">
                            <img src="../img/m.jpg">
                         </li>
                        <li tabindex="9" class="li">
                            <img src="../img/m.jpg">
                         </li>
                        <li tabindex="10" class="li">
                            <img src="../img/m.jpg">
                         </li>
                        <li tabindex="11" class="li">
                            <img src="../img/m.jpg">
                         </li>
                        <li tabindex="12" class="li">
                            <img src="../img/m.jpg">
                         </li>
                        <li tabindex="13" class="li">
                            <img src="../img/m.jpg">
                         </li>
                    </ul>
                </div>
           </div>
        </div>
        </div>
    </div>
</body>
<script src="../js/jquery-1.12.4.min.js"></script>
<script src="../js/common.js"></script>

<script type="text/javascript">
// 键盘事件开始
$(function() {
    var jqThis;
    var colThis;
    var startAnimate = false
    var seltWidth;
    var totalWhidth = document.documentElement.scrollWidth;
    var screenWidth = document.body.offsetWidth;

    $(window).keydown(function (e) {
        e.stopPropagation()
        e.preventDefault()
        // console.log(e.keyCode)
        $('.li').each(function () { // 左右的this
            if ($(this).hasClass('active')) {
                jqThis = $(this)
                seltWidth = $(this).width() + 200
            }
        });
        $('.col').each(function () { // 上下的this
            if ($(this).hasClass('aty')) {
                colThis = $(this)
            }
        });
        // console.log(e.keyCode)
        if(e.keyCode==38){ // 上
            if (colThis.prev().length === 0) {
                $('.col').last().addClass('aty')
                $('.col').last().find('.li').eq(0).addClass('active')
                bottom()
                $('.col').last().find('.tj').animate({
                    left: '0px'
                })
            }else {
                tops()
            }
            if (colThis.prev().hasClass('selectNumber')){ // 如果默认在 1-10集
                number('1-10')
            }


            colThis.prev().addClass('aty')
            colThis.prev().find('.li').eq(0).addClass('active')
            colThis.removeClass('aty')
            colThis.find('.li').removeClass('active')
        }
        if(e.keyCode==40){ // 下
            if (colThis.next().length === 0) { // 这是到头啦
                $('.col').first().addClass('aty')
                $('.col').first().find('.li').eq(0).addClass('active')
                tops()
            }
            if (colThis.next().hasClass('selectNumber')){ // 如果默认在 1-10集
                number('1-10')
            }
            if (colThis.next().hasClass('details_tj')) { // 推荐
                bottom()
                colThis.next().children().find('.tj').animate({
                    left: '0px'
                })
            }
            colThis.next().addClass('aty')
            colThis.next().find('.li').eq(0).addClass('active')
            colThis.removeClass('aty')
            colThis.find('.li').removeClass('active')
        }
        if(e.keyCode==39){ // 右-39
            if(jqThis.parents().hasClass('videoCon')){ // 父元素是1
                if (jqThis.next().length === 0) { // 这是到头啦
                    jqThis.parents('.aty').find('.li').eq(0).addClass('active')
                } else {
                    jqThis.removeClass('active')
                    jqThis.next().addClass('active')
                }

                // 选择数字的时候输出的数字
            } else if (jqThis.parents().hasClass('setNumber')) {
                if (mod() == 0) {
                    jqThis.parents('.aty').find('.li').eq(0).addClass('active')
                }else{
                    if (jqThis.next().length === 0 || jqThis.next().css('display') === 'none') { // 这是到头啦
                        jqThis.parents('.aty').find('.li').eq(0).addClass('active')
                        jqThis.removeClass('active')
                    } else {
                        jqThis.removeClass('active')
                        jqThis.next().addClass('active')
                    }
                }
            } else if (jqThis.parents().hasClass('selectNumber')){ // 数字选择
                if (jqThis.next().length === 0) { // 这是到头啦
                    jqThis.parents('.aty').find('.li').eq(0).addClass('active')
                    number(jqThis.parents('.aty').find('.li').eq(0).html())
                } else {
                    number(jqThis.next().html())
                }
                jqThis.removeClass('active')
                jqThis.next().addClass('active')
            } else if (jqThis.parents().hasClass('tuijian')) {
                if (!startAnimate) {
                    startAnimate = true
                    jqThis.removeClass('active')
                    if (jqThis.next().length === 0) { // 这是到头啦
                        jqThis.parents('.aty').find('.li').eq(0).addClass('active')
                        jqThis.parents('.tj').animate({
                            left: '0px'
                        })
                        startAnimate = false
                        return
                    }
                    // jqThis.scrollLeft(200)
                    if (totalWhidth - seltWidth - jqThis.next().position().left <= 20) {
                        jqThis.parents('.tj').animate({
                            left: totalWhidth - seltWidth - jqThis.next().position().left - 40 + 'px'
                        })
                    }
                    jqThis.next().addClass('active')
                }

            }
        }
        if(e.keyCode==37){ // 左-37
            if(jqThis.parents().hasClass('videoCon')){ // 父元素是1
                if (jqThis.prev().length === 0) { // 这是到头啦
                    jqThis.parents('.aty').find('.li').last().addClass('active')
                } else {
                    jqThis.removeClass('active') //
                    jqThis.prev().addClass('active')
                }

                // 选择数字的时候输出的数字
            } else if (jqThis.parents().hasClass('setNumber')) {
                if (mod() == 0) {
                    jqThis.parents('.aty').find('.li').eq(0).addClass('active')
                }else{
                    if (jqThis.prev().length === 0) { // 这是到头啦
                        jqThis.parents('.aty').find('.li').eq(mod()).addClass('active')
                        jqThis.removeClass('active')
                    } else {
                        jqThis.removeClass('active')
                        jqThis.prev().addClass('active')
                    }
                }
            } else if (jqThis.parents().hasClass('selectNumber')){ // 数字选择
                if (jqThis.prev().length === 0) { // 这是到头啦
                    jqThis.parents('.aty').find('.li').last().addClass('active')
                    number(jqThis.parents('.aty').find('.li').last().html())
                } else {
                    number(jqThis.prev().html())
                }
                jqThis.removeClass('active') //
                jqThis.prev().addClass('active')
            } else if (jqThis.parents().hasClass('tuijian')) {
                if (!startAnimate) {
                    startAnimate = true
                    jqThis.removeClass('active')
                    if(jqThis.parent().hasClass('tj')){ // 父元素是1
                        if (jqThis.prev().length === 0) { // 这是到头啦
                            jqThis.parents('.aty').find('.li').last().addClass('active')
                            jqThis.parents('.tj').animate({
                                left: totalWhidth - seltWidth - jqThis.parents('.tj').find('.li').last().position().left - 50 + 'px'
                            })
                            startAnimate = false
                            return
                        }
                        var offsetRight = screenWidth - jqThis.next().offset().left - seltWidth
                        var parentOffsetL = jqThis.parents('.tj').offset().left
                        var nextL = jqThis.next().position().left
                        var nextOffsetL = parentOffsetL + nextL
                        var nextoffsetR = screenWidth - nextOffsetL - seltWidth
                        if (totalWhidth - seltWidth - jqThis.next().position().left <= 20) {
                            if (nextoffsetR < 0) {
                                jqThis.parents('.tj').animate({
                                    left: totalWhidth - seltWidth - jqThis.next().position().left - 20 + 'px'
                                })
                            }
                        }
                        jqThis.prev().addClass('active')
                    }
                }

            }
        }
        if(e.keyCode==13){ // enter
            if (jqThis.hasClass('play')) {
                window.location.href='../broadcast.html'
            }else if (jqThis.parent().hasClass('tj')){
                window.location.href='detailsSingle.html'
            }
        }
        // 返回上一页
        if (e.keyCode == 8) { // backspace
            window.history.go(-1)
        }
        setTimeout(function () {
            startAnimate = false
        }, 200)
    })

    // 返回当前集数的 index
    function mod() {
        var index = 0
        $(".setNumber .li").each(function (item,i) {
            if ($(this).css('display') == 'block') {
                index = $(this).index()
            }
        })
        return index
    }

    function scrollToEnd(){//滚动到底部
        var h = $(document).height()-$(window).height();
        $(document).scrollTop(h);
    }
})

</script>
</html>
